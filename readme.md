# Бинарная классификация изображений — кошки / собаки

**Кратко:** проект реализует пайплайн для обучения и инференса модели бинарной классификации изображений (кошки vs собаки) на базе предобученной EfficientNet-B0. Код подготовлен для запуска в Google Colab — включает загрузку датасета, подготовку DataLoader, адаптацию предобученной сети, обучение с помощью PyTorch-Ignite, сохранение контрольных точек, визуализацию метрик и пример инференса на одном изображении.

---

## Содержание

- Датасет

- Модель

- Обучение

- Валидация и визуализация

---

## Датасет

В проекте используется `cats_and_dogs_filtered` (Google ML Edu), который содержит заранее разделённые папки `train` и `validation` для двух классов (`cats`, `dogs`). В коде он скачивается и распаковывается командой `wget` и `shutil.unpack_archive`.

## Модель

- Используется `torchvision.models.efficientnet_b0` с предобученными весами `IMAGENET1K_V1`.
- Последний полносвязный слой (`classifier[1]`) заменяется на `nn.Linear(1280, 2)` для бинарной классификации.
- В примере большая часть слоёв заморожена (`param.requires_grad = False`), обучаются только параметры нового классификатора (тонкая настройка — fine-tuning только head).

**Параметры:**

- Оптимизатор: `Adam` с lr=3e-4
- Loss: `CrossEntropyLoss`

## Обучение

- В качестве тренера используется PyTorch-Ignite:
  - `create_supervised_trainer` для обучения
  - `create_supervised_evaluator` для расчёта метрик на train/val
- Метрики: `Accuracy`, `Loss`, `ConfusionMatrix` (через Ignite)
- EarlyStopping: `ignite.handlers.EarlyStopping` с `patience=10` (отслеживание метрики accuracy на валидации)
- Checkpoint: `ignite.handlers.Checkpoint` сохраняет лучшую контрольную точку в папку `./models` (по accuracy)

## Валидация и визуализация

В коде после каждой эпохи считается и печатается средняя точность и loss на трейне и валидации. После завершения обучения строятся:

- Confusion Matrix (heatmap через seaborn)
- Графики истории обучения и валидации (accuracy / loss)

